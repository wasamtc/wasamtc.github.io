---
layout:     post
title:      如何使用gdb调试MIT6.S081
subtitle:   gdb
date:       2026-01-12
author:     tangcong
header-img: img/gdb.png
catalog: true
tags:
    - MIT6.S081
---

# MIT6.S081的gdb调试方法

## 概述

在做MIT6.S081实验的时候，我们可能会用到gdb来调试程序。以下是具体方法：

## 1. 配置环境

首先根据官方指南配置好MIT6.S081，具体可见：MIT6.S081实验环境搭建

配置好环境后，在命令行中输入命令：

```
sudo make qemu-gdb
```

另开一个终端，输入命令：

```
gdb-multiarch
```

如果提示没有gdb-multiarch，使用命令安装：

```
sudo apt-get install gdb-multiarch
```

如果启动gdb-multiarch的提示信息没有`The target architecture is assumed to be riscv:rv64`，那么（每次）启动后需要输入：

```
set architecture riscv:rv64
```

## 2. 连接qemu-gdb

在上面输入`sudo make qemu-gdb`之后，出现的信息里面包含端口信息，例如：

```
localhost:25000
```

根据这个端口，在gdb-multiarch中输入：

```
target remote localhost:25000
```

此时就成功连接上了。

## 3. 加载可执行文件进行调试

使用命令加载可执行文件：

```
file user/_xxx
```

例如：

```
file user/_sleep
```

（注意有下划线）

这个时候可以开始打断点了，例如：

```
b main
```

然后多次输入`c`继续执行，输入到原来的终端应该会有变化。在这里就要输入我们程序的参数了，第一个参数是程序的名字，后面的参数视具体情况而定，例如sleep应该有一个表示多少时间的参数。

此后就可以继续调试了。总之gdb-multiarch的调试方法和gdb类似。

## 4. 保存调试配置

每次调试都要设置riscv:rv64和端口比较麻烦，可以将这两个步骤直接写到配置文件中：

1. 

   用`nano ~/.gdbinit`打开配置文件

2. 

   把以下内容写入配置文件：

   ```
   set architecture riscv:rv64
   target remote localhost:25000
   ```

3. 

   按下Ctrl+O，再按下enter键保存

4. 

   按下Ctrl+X退出即可

此时再次运行gdb-multiarch就可以直接调试了。